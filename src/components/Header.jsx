import React, { useEffect, useState } from 'react'
import { Link, NavLink, useLocation } from 'react-router-dom'


import logo from '../img/logo.svg'
import Hero from './Hero'


const Header = () => {
    // navbar
    const [openNavbar, setOpenNavbar] = useState(false);
    const [isHome, setIsHome] = useState(true);
    const location = useLocation();
    useEffect(() => {
        if (location.pathname === '/') {
            setIsHome(true);
        } else {
            setIsHome(false);
        };
        setOpenNavbar(false);
    }, [location]);

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            setOpenNavbar(false);
        };
    });
    window.addEventListener('resize', () => {
        if (window.innerWidth > 768) {
            setOpenNavbar(false);
        };
    });

    return (
        <div className={`${isHome ? 'bg-heroBg' : 'bg-white'} bg-cover bg-bottom bg-no-repeat`}>
            <header className='py-5 border-b-2 border-white/40 z-10 backdrop-filte backdrop-blur-3x'>
                <div className="flex justify-between items-center w-full max-w-base mx-auto px-5">
                    <Link aria-label='home' title='mashina bozor' className='flex items-center justify-center text-xl text-white font-semibold leading-none space-x-1' to='/'>
                        <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M34.7527 19.4217C34.4996 16.5804 34.0826 16.027 33.9251 15.8189C33.563 15.338 32.9837 15.0237 32.3705 14.6939C32.3359 14.6756 32.3059 14.6494 32.2831 14.6175C32.2602 14.5857 32.2451 14.5489 32.2389 14.5102C32.2327 14.4715 32.2356 14.4318 32.2473 14.3944C32.2591 14.357 32.2793 14.3228 32.3066 14.2945C32.4201 14.1794 32.5074 14.041 32.5623 13.8889C32.6173 13.7368 32.6387 13.5747 32.6251 13.4135C32.5986 13.1278 32.4658 12.8624 32.2528 12.67C32.0399 12.4777 31.7624 12.3724 31.4755 12.375H30.3786C30.3316 12.3753 30.2846 12.3783 30.238 12.3841C30.2059 12.3703 30.1728 12.3592 30.1388 12.3511C29.4891 10.9779 28.5997 9.09773 26.7561 8.18016C24.0216 6.82031 18.9844 6.75 18.0001 6.75C17.0157 6.75 11.9785 6.82031 9.24757 8.17805C7.40398 9.09562 6.51452 10.9758 5.86484 12.349L5.85921 12.3602C5.82681 12.3648 5.79499 12.3728 5.76429 12.3841C5.71763 12.3783 5.67068 12.3753 5.62366 12.375H4.52468C4.23773 12.3724 3.96027 12.4777 3.74732 12.67C3.53438 12.8624 3.40151 13.1278 3.37507 13.4135C3.36258 13.5743 3.38495 13.7358 3.44065 13.8872C3.49635 14.0385 3.58407 14.176 3.6978 14.2903C3.72501 14.3186 3.74529 14.3527 3.75702 14.3902C3.76876 14.4276 3.77164 14.4672 3.76544 14.506C3.75923 14.5447 3.74411 14.5814 3.72127 14.6133C3.69843 14.6452 3.66849 14.6714 3.63382 14.6897C3.02069 15.0216 2.43851 15.3359 2.07921 15.8147C1.92171 16.0256 1.50546 16.5762 1.25163 19.4175C1.11101 21.0164 1.08991 22.6716 1.2003 23.7375C1.43163 25.9523 1.86546 27.2911 1.88374 27.3466C1.95031 27.5488 2.07285 27.7279 2.23714 27.8632C2.40142 27.9985 2.60071 28.0844 2.81187 28.1109V28.125C2.81187 28.4234 2.93039 28.7095 3.14137 28.9205C3.35235 29.1315 3.6385 29.25 3.93687 29.25H7.87437C8.17274 29.25 8.45888 29.1315 8.66986 28.9205C8.88084 28.7095 8.99937 28.4234 8.99937 28.125C9.60476 28.125 10.0259 28.0167 10.4724 27.9014C11.117 27.7277 11.7759 27.6122 12.4412 27.5562C14.5864 27.3516 16.7197 27.2812 18.0001 27.2812C19.2544 27.2812 21.4819 27.3516 23.6307 27.5562C24.2986 27.6123 24.9601 27.7283 25.6072 27.9028C26.0347 28.0125 26.4404 28.1137 27.0022 28.1243C27.0022 28.4227 27.1207 28.7088 27.3317 28.9198C27.5427 29.1308 27.8288 29.2493 28.1272 29.2493H32.0647C32.3631 29.2493 32.6492 29.1308 32.8602 28.9198C33.0712 28.7088 33.1897 28.4227 33.1897 28.1243V28.1159C33.4013 28.0898 33.6012 28.0041 33.7661 27.8688C33.9309 27.7335 34.0538 27.5541 34.1206 27.3516C34.1389 27.296 34.5727 25.9573 34.8041 23.7424C34.9144 22.6758 34.8948 21.0234 34.7527 19.4217ZM7.89827 13.3109C8.46077 12.1155 9.10413 10.7627 10.2495 10.1925C11.9047 9.36844 15.3352 8.99719 18.0001 8.99719C20.6649 8.99719 24.0955 9.36563 25.7506 10.1925C26.896 10.7627 27.5366 12.1162 28.1019 13.3109L28.1722 13.4634C28.2133 13.5503 28.2315 13.6462 28.225 13.7421C28.2185 13.838 28.1875 13.9306 28.1351 14.0111C28.0826 14.0917 28.0104 14.1574 27.9253 14.2021C27.8402 14.2468 27.7451 14.2689 27.6491 14.2664C25.3126 14.2031 20.3907 14.0006 18.0001 14.0006C15.6094 14.0006 10.6876 14.208 8.34757 14.2713C8.2515 14.2738 8.15639 14.2517 8.07131 14.207C7.98623 14.1623 7.91402 14.0966 7.86156 14.0161C7.8091 13.9355 7.77815 13.8429 7.77165 13.747C7.76515 13.6512 7.78333 13.5552 7.82445 13.4684C7.84905 13.4163 7.87507 13.3636 7.89827 13.3109ZM8.7371 18.9098C7.52759 19.0554 6.31034 19.1273 5.0921 19.125C4.34679 19.125 3.57827 18.9141 3.43554 18.2503C3.3378 17.8038 3.34835 17.5528 3.40109 17.3004C3.44538 17.0859 3.51569 16.9298 3.86726 16.875C4.78132 16.7344 5.29249 16.9109 6.78874 17.3517C7.78085 17.6435 8.49663 18.0323 8.90444 18.3403C9.10905 18.4922 9.00007 18.8887 8.7371 18.9098ZM24.3029 24.6755C23.3776 24.7809 21.5269 24.7423 18.0212 24.7423C14.5154 24.7423 12.6655 24.7809 11.7401 24.6755C10.7853 24.5693 9.56819 23.6665 10.3993 22.8621C10.9526 22.332 12.2436 21.9354 13.9627 21.7125C15.6819 21.4896 16.4096 21.375 18.0141 21.375C19.6187 21.375 20.2726 21.4453 22.0655 21.7132C23.8585 21.9811 25.2134 22.3826 25.629 22.8628C26.3869 23.7234 25.257 24.5637 24.3029 24.6797V24.6755ZM32.5646 18.2496C32.424 18.9162 31.6505 19.1243 30.908 19.1243C29.6665 19.1246 28.426 19.0527 27.1927 18.9091C26.9776 18.8887 26.8777 18.5112 27.0957 18.3396C27.4972 18.0239 28.2207 17.6428 29.2114 17.351C30.7077 16.9102 31.5704 16.7337 32.3115 16.8806C32.4922 16.9165 32.5878 17.1105 32.5991 17.2322C32.6486 17.5709 32.637 17.915 32.5646 18.2496Z"
                                fill={`${isHome ? '#fff' : '#E70A32'}`} />
                        </svg>
                        <h1 className={`${isHome ? 'text-white' : 'text-main'}  max-410:hidden`}>Mashina <span className={`${isHome ? 'text-white' : 'text-111'}`}>bozor</span></h1>
                    </Link>

                    {/* navbar wrapper + responsive navbar*/}
                    <div className={`${openNavbar ? 'translate-x-0' : 'max-768:-translate-x-full'} transition-transform duration-300 flex flex-col top-0 left-0 max-768:fixed max-768:bg-white max-768:h-screen max-768:z-30 max-768:py-6 max-768:px-5 max-768:overflow-y-auto`}>
                        <Link aria-label='home' title='mashina bozor' className='hidden max-768:flex items-center text-xl text-white font-semibold leading-none space-x-1 mb-6' to='/'>
                            <img width={36} height={36} src={logo} alt="logo" />
                            <h1 className='text-main'>Mashina <span className='text-111'>bozor</span></h1>
                        </Link>

                        <nav className='mb-auto'>
                            <ul className={`${isHome ? 'text-white' : 'text-111'} flex items-center gap-8 text-lg font-medium leading-7 max-768:flex-col max-768:!text-111 max-768:items-start max-768:gap-3`}>
                                <li>
                                    <NavLink to='/catalog'>Katalog</NavLink>
                                </li>
                                <li>
                                    <NavLink to='/news'>Yangiliklar</NavLink>
                                </li>
                                <li>
                                    <NavLink to='/contact'>Bog'lanish</NavLink>
                                </li>
                            </ul>
                        </nav>

                        {/* call */}
                        <a title='contact' aria-label='contact' className='hidden max-768:flex items-center justify-center gap-3 px-6 py-2.5 rounded-full bg-main w-64 mt-5 max-360:w-auto' href="tel:+998881690033">
                            <svg width="24" height="24" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.9727 19.0348L18.6721 17.3346C18.9336 17.0699 19.245 16.8595 19.5882 16.7161C19.9315 16.5726 20.2998 16.4989 20.6717 16.4989C21.0438 16.4989 21.412 16.5726 21.7554 16.7161C22.0986 16.8595 22.4099 17.0699 22.6714 17.3346L24.6646 19.3288C24.9292 19.5903 25.1394 19.9016 25.2828 20.245C25.4261 20.5884 25.5 20.957 25.5 21.3291C25.5 21.7013 25.4261 22.0699 25.2828 22.4133C25.1394 22.7567 24.9292 23.0679 24.6646 23.3294L23.7574 24.2498C23.1324 24.8812 22.3239 25.2992 21.4474 25.4438C20.5709 25.5883 19.6711 25.4525 18.8765 25.0552C12.0385 21.5338 6.46884 15.9662 2.94327 9.12839C2.54581 8.33259 2.41085 7.43118 2.55779 6.55381C2.70473 5.67642 3.126 4.86816 3.76104 4.24542L4.66818 3.32512C5.19962 2.79667 5.91851 2.5 6.66782 2.5C7.41714 2.5 8.13602 2.79667 8.66747 3.32512L10.6735 5.33204C11.2018 5.86371 11.4983 6.5828 11.4983 7.33242C11.4983 8.08204 11.2018 8.80113 10.6735 9.3328L8.97411 11.033C10.0978 12.5535 11.332 13.9888 12.6667 15.3276C13.9938 16.6575 15.4205 17.8841 16.9344 18.9964L16.9727 19.0348Z" stroke='#fff' strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                            </svg>
                            <span className='font-medium text-lg text-white'>Telefon raqam</span>
                        </a>
                    </div>


                    <div className="flex items-center gap-8 z-20">
                        {/* search */}
                        <button title='search' aria-label='search button'>
                            <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M23.7929 25.2071C24.1834 25.5976 24.8166 25.5976 25.2071 25.2071C25.5976 24.8166 25.5976 24.1834 25.2071 23.7929L23.7929 25.2071ZM18.3484 19.7624L23.7929 25.2071L25.2071 23.7929L19.7627 18.3482L18.3484 19.7624ZM12.3889 20.2775C8.03198 20.2775 4.5 16.7456 4.5 12.3886H2.5C2.5 17.8501 6.92741 22.2775 12.3889 22.2775V20.2775ZM20.2778 12.3886C20.2778 16.7456 16.7458 20.2775 12.3889 20.2775V22.2775C17.8504 22.2775 22.2778 17.8501 22.2778 12.3886H20.2778ZM12.3889 4.49976C16.7458 4.49976 20.2778 8.03173 20.2778 12.3886H22.2778C22.2778 6.92716 17.8504 2.49976 12.3889 2.49976V4.49976ZM12.3889 2.49976C6.92741 2.49976 2.5 6.92716 2.5 12.3886H4.5C4.5 8.03173 8.03198 4.49976 12.3889 4.49976V2.49976Z"
                                    fill={`${isHome ? '#fff' : '#111'}`} />
                            </svg>
                        </button>


                        {/* favorites link */}
                        <Link aria-label='favorites' to='/favorites' className='relative btn-normal'>
                            <svg width="28" height="28" viewBox="0 0 29 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path className='transition-colors' d="M13.2261 6.99763L14.2996 7.91784C14.3548 7.96512 14.4362 7.96512 14.4914 7.91784L15.5649 6.99763C18.5678 4.42372 23.1789 5.26951 25.0728 8.74164C26.4382 11.2449 25.9265 14.356 23.8312 16.2901L14.6961 24.7225C14.5264 24.8792 14.2647 24.8792 14.0949 24.7225L4.95978 16.2901C2.86453 14.356 2.35283 11.2449 3.71825 8.74164C5.61214 5.26951 10.2232 4.42372 13.2261 6.99763Z" stroke={`${isHome ? '#fff' : '#111'}`} strokeWidth="2" />
                            </svg>

                            {/* count */}
                            <span className="flex items-center justify-center absolute w-5 h-5 rounded-full text-white bg-main -top-1 -right-3 text-xs leading-none font-bold">0</span>
                        </Link>

                        {/* call */}
                        <a title='contact' aria-label='contact' className='max-768:hidden' href="tel:+998881690033">
                            <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.9727 19.0348L18.6721 17.3346C18.9336 17.0699 19.245 16.8595 19.5882 16.7161C19.9315 16.5726 20.2998 16.4989 20.6717 16.4989C21.0438 16.4989 21.412 16.5726 21.7554 16.7161C22.0986 16.8595 22.4099 17.0699 22.6714 17.3346L24.6646 19.3288C24.9292 19.5903 25.1394 19.9016 25.2828 20.245C25.4261 20.5884 25.5 20.957 25.5 21.3291C25.5 21.7013 25.4261 22.0699 25.2828 22.4133C25.1394 22.7567 24.9292 23.0679 24.6646 23.3294L23.7574 24.2498C23.1324 24.8812 22.3239 25.2992 21.4474 25.4438C20.5709 25.5883 19.6711 25.4525 18.8765 25.0552C12.0385 21.5338 6.46884 15.9662 2.94327 9.12839C2.54581 8.33259 2.41085 7.43118 2.55779 6.55381C2.70473 5.67642 3.126 4.86816 3.76104 4.24542L4.66818 3.32512C5.19962 2.79667 5.91851 2.5 6.66782 2.5C7.41714 2.5 8.13602 2.79667 8.66747 3.32512L10.6735 5.33204C11.2018 5.86371 11.4983 6.5828 11.4983 7.33242C11.4983 8.08204 11.2018 8.80113 10.6735 9.3328L8.97411 11.033C10.0978 12.5535 11.332 13.9888 12.6667 15.3276C13.9938 16.6575 15.4205 17.8841 16.9344 18.9964L16.9727 19.0348Z" stroke={isHome ? '#fff' : '#111'} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                            </svg>
                        </a>

                        {/* hamburger */}
                        <button
                            title='hamburger button'
                            aria-label='hamburger button'
                            className={`hamburger-btn ${openNavbar ? 'hamburger-btn-active' : ''}`}
                            onClick={() => {
                                setOpenNavbar(!openNavbar);
                            }}
                        >
                            <span className='hamburger-btn_items-wrapper'>
                                <span className={`hamburger-btn_item ${(isHome) ? '' : (openNavbar ? 'bg-white' : '!bg-111')}`}></span>
                                <span className={`hamburger-btn_item ${(isHome) ? '' : (openNavbar ? 'bg-white' : '!bg-111')}`}></span>
                                <span className={`hamburger-btn_item ${(isHome) ? '' : (openNavbar ? 'bg-white' : '!bg-111')}`}></span>
                            </span>
                        </button>

                        {/* overlay */}
                        <div
                            className={`${openNavbar ? 'max-768:block' : 'hidden'} fixed top-0 right-0 z-20 bg-black/70 w-full min-h-screen`}
                            onClick={() => {
                                setOpenNavbar(false);
                            }}
                        ></div>
                    </div>


                </div>
            </header>
            {
                isHome &&
                <Hero />
            }
        </div>
    )
}

export default Header